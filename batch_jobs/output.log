
*********************************************************
This was run on:
Tue Nov 27 19:54:03 EST 2018
*********************************************************

*********************************************************
Running python train_model.py
JOB 5148 is running on node03 
*********************************************************


Reading info from configuration:

Runnning in training setting!

NUM_TRAINING: 3626
NUM_VALIDATION: 514
NUM_EPOCHS: 30
BATCH_SIZE: 2
IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TRAINING: /scratch/arbint/input_files/training/feature_w.csv
LABEL_FILE_TRAINING: /scratch/arbint/input_files/training/label_w.csv
FEATURE_FILE_VALIDATION: /scratch/arbint/input_files/validation/feature_w.csv
LABEL_FILE_VALIDATION: /scratch/arbint/input_files/validation/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]

Old weights found!
Old weights loaded successfully!
Epoch 1/30
 - 841s - loss: 0.0785 - acc: 0.0324 - val_loss: 0.0630 - val_acc: 0.0178

Epoch 00001: val_loss improved from inf to 0.06304, saving model to saved_models/model_and_weights.hdf5
Epoch 2/30
 - 791s - loss: 0.0779 - acc: 0.0330 - val_loss: 0.0625 - val_acc: 0.0179

Epoch 00002: val_loss improved from 0.06304 to 0.06248, saving model to saved_models/model_and_weights.hdf5
Epoch 3/30
 - 792s - loss: 0.0773 - acc: 0.0335 - val_loss: 0.0620 - val_acc: 0.0183

Epoch 00003: val_loss improved from 0.06248 to 0.06196, saving model to saved_models/model_and_weights.hdf5
Epoch 4/30
 - 791s - loss: 0.0768 - acc: 0.0340 - val_loss: 0.0615 - val_acc: 0.0186

Epoch 00004: val_loss improved from 0.06196 to 0.06150, saving model to saved_models/model_and_weights.hdf5
Epoch 5/30
 - 793s - loss: 0.0763 - acc: 0.0345 - val_loss: 0.0611 - val_acc: 0.0188

Epoch 00005: val_loss improved from 0.06150 to 0.06108, saving model to saved_models/model_and_weights.hdf5
Epoch 6/30
 - 793s - loss: 0.0759 - acc: 0.0350 - val_loss: 0.0607 - val_acc: 0.0194

Epoch 00006: val_loss improved from 0.06108 to 0.06070, saving model to saved_models/model_and_weights.hdf5
Epoch 7/30
 - 798s - loss: 0.0755 - acc: 0.0355 - val_loss: 0.0604 - val_acc: 0.0195

Epoch 00007: val_loss improved from 0.06070 to 0.06035, saving model to saved_models/model_and_weights.hdf5
Epoch 8/30
 - 794s - loss: 0.0751 - acc: 0.0360 - val_loss: 0.0600 - val_acc: 0.0197

Epoch 00008: val_loss improved from 0.06035 to 0.06004, saving model to saved_models/model_and_weights.hdf5
Epoch 9/30
 - 794s - loss: 0.0747 - acc: 0.0365 - val_loss: 0.0598 - val_acc: 0.0201

Epoch 00009: val_loss improved from 0.06004 to 0.05978, saving model to saved_models/model_and_weights.hdf5
Epoch 10/30
 - 793s - loss: 0.0744 - acc: 0.0371 - val_loss: 0.0595 - val_acc: 0.0207

Epoch 00010: val_loss improved from 0.05978 to 0.05952, saving model to saved_models/model_and_weights.hdf5
Epoch 11/30
 - 791s - loss: 0.0741 - acc: 0.0376 - val_loss: 0.0593 - val_acc: 0.0208

Epoch 00011: val_loss improved from 0.05952 to 0.05927, saving model to saved_models/model_and_weights.hdf5
Epoch 12/30
 - 792s - loss: 0.0738 - acc: 0.0381 - val_loss: 0.0591 - val_acc: 0.0216

Epoch 00012: val_loss improved from 0.05927 to 0.05906, saving model to saved_models/model_and_weights.hdf5
Epoch 13/30
 - 792s - loss: 0.0735 - acc: 0.0386 - val_loss: 0.0589 - val_acc: 0.0218

Epoch 00013: val_loss improved from 0.05906 to 0.05886, saving model to saved_models/model_and_weights.hdf5
Epoch 14/30
 - 792s - loss: 0.0732 - acc: 0.0392 - val_loss: 0.0587 - val_acc: 0.0222

Epoch 00014: val_loss improved from 0.05886 to 0.05867, saving model to saved_models/model_and_weights.hdf5
Epoch 15/30
 - 791s - loss: 0.0729 - acc: 0.0397 - val_loss: 0.0585 - val_acc: 0.0223

Epoch 00015: val_loss improved from 0.05867 to 0.05849, saving model to saved_models/model_and_weights.hdf5
Epoch 16/30
 - 790s - loss: 0.0727 - acc: 0.0402 - val_loss: 0.0583 - val_acc: 0.0226

Epoch 00016: val_loss improved from 0.05849 to 0.05834, saving model to saved_models/model_and_weights.hdf5
Epoch 17/30
 - 792s - loss: 0.0724 - acc: 0.0408 - val_loss: 0.0582 - val_acc: 0.0230

Epoch 00017: val_loss improved from 0.05834 to 0.05820, saving model to saved_models/model_and_weights.hdf5
Epoch 18/30
 - 791s - loss: 0.0722 - acc: 0.0413 - val_loss: 0.0581 - val_acc: 0.0237

Epoch 00018: val_loss improved from 0.05820 to 0.05805, saving model to saved_models/model_and_weights.hdf5
Epoch 19/30
 - 791s - loss: 0.0719 - acc: 0.0418 - val_loss: 0.0579 - val_acc: 0.0242

Epoch 00019: val_loss improved from 0.05805 to 0.05791, saving model to saved_models/model_and_weights.hdf5
Epoch 20/30
 - 792s - loss: 0.0717 - acc: 0.0424 - val_loss: 0.0578 - val_acc: 0.0251

Epoch 00020: val_loss improved from 0.05791 to 0.05778, saving model to saved_models/model_and_weights.hdf5
Epoch 21/30
 - 792s - loss: 0.0715 - acc: 0.0429 - val_loss: 0.0577 - val_acc: 0.0254

Epoch 00021: val_loss improved from 0.05778 to 0.05769, saving model to saved_models/model_and_weights.hdf5
Epoch 22/30
 - 792s - loss: 0.0713 - acc: 0.0435 - val_loss: 0.0576 - val_acc: 0.0257

Epoch 00022: val_loss improved from 0.05769 to 0.05756, saving model to saved_models/model_and_weights.hdf5
Epoch 23/30
 - 792s - loss: 0.0711 - acc: 0.0440 - val_loss: 0.0574 - val_acc: 0.0261

Epoch 00023: val_loss improved from 0.05756 to 0.05745, saving model to saved_models/model_and_weights.hdf5
Epoch 24/30
 - 791s - loss: 0.0709 - acc: 0.0445 - val_loss: 0.0573 - val_acc: 0.0266

Epoch 00024: val_loss improved from 0.05745 to 0.05733, saving model to saved_models/model_and_weights.hdf5
Epoch 25/30
 - 794s - loss: 0.0706 - acc: 0.0451 - val_loss: 0.0572 - val_acc: 0.0271

Epoch 00025: val_loss improved from 0.05733 to 0.05723, saving model to saved_models/model_and_weights.hdf5
Epoch 26/30
 - 793s - loss: 0.0705 - acc: 0.0456 - val_loss: 0.0571 - val_acc: 0.0273

Epoch 00026: val_loss improved from 0.05723 to 0.05713, saving model to saved_models/model_and_weights.hdf5
Epoch 27/30
 - 792s - loss: 0.0703 - acc: 0.0462 - val_loss: 0.0570 - val_acc: 0.0274

Epoch 00027: val_loss improved from 0.05713 to 0.05703, saving model to saved_models/model_and_weights.hdf5
Epoch 28/30
 - 793s - loss: 0.0701 - acc: 0.0467 - val_loss: 0.0569 - val_acc: 0.0275

Epoch 00028: val_loss improved from 0.05703 to 0.05695, saving model to saved_models/model_and_weights.hdf5
Epoch 29/30
 - 792s - loss: 0.0699 - acc: 0.0473 - val_loss: 0.0569 - val_acc: 0.0278

Epoch 00029: val_loss improved from 0.05695 to 0.05685, saving model to saved_models/model_and_weights.hdf5
Epoch 30/30
 - 792s - loss: 0.0697 - acc: 0.0478 - val_loss: 0.0567 - val_acc: 0.0281

Epoch 00030: val_loss improved from 0.05685 to 0.05674, saving model to saved_models/model_and_weights.hdf5
*********************************************************
Running python analyze_model.py
JOB 5148 is running on node03 
*********************************************************


Running over 5 testing events to generate plots.

Reading info from configuration:
Running over 25 testing events to calculate statistics.

IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TESTING: /scratch/arbint/input_files/testing/feature_w.csv
LABEL_FILE_TESTING: /scratch/arbint/input_files/testing/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]


Number of validation samples IoU evaulated on: 25
IoU for Background is: 0.176
IoU for Cosmic is: 0.165
IoU for Beam is: 0.023
Average IoU is: 0.121

Test accuracy of the model is: 14.09%

Done!

