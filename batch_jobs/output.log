
*********************************************************
This was run on:
Tue Nov 27 15:52:25 EST 2018
*********************************************************

*********************************************************
Running python train_model.py
JOB 5141 is running on node01 
*********************************************************


Reading info from configuration:

Runnning in training setting!

NUM_TRAINING: 3626
NUM_VALIDATION: 514
NUM_EPOCHS: 15
BATCH_SIZE: 2
IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TRAINING: /scratch/arbint/input_files/training/feature_w.csv
LABEL_FILE_TRAINING: /scratch/arbint/input_files/training/label_w.csv
FEATURE_FILE_VALIDATION: /scratch/arbint/input_files/validation/feature_w.csv
LABEL_FILE_VALIDATION: /scratch/arbint/input_files/validation/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]

Epoch 1/15
 - 839s - loss: 3.2918e-04 - acc: 0.4314 - val_loss: 0.0108 - val_acc: 0.2865

Epoch 00001: val_loss improved from inf to 0.01082, saving model to saved_models/model_and_weights.hdf5
Epoch 2/15
 - 791s - loss: 3.2728e-04 - acc: 0.4312 - val_loss: 0.0109 - val_acc: 0.2800

Epoch 00002: val_loss did not improve from 0.01082
Epoch 3/15
 - 792s - loss: 3.2941e-04 - acc: 0.4310 - val_loss: 0.0110 - val_acc: 0.2768

Epoch 00003: val_loss did not improve from 0.01082

Epoch 00003: ReduceLROnPlateau reducing learning rate to 2.499999936844688e-06.
Epoch 4/15
 - 791s - loss: 3.2793e-04 - acc: 0.4309 - val_loss: 0.0110 - val_acc: 0.2771

Epoch 00004: val_loss did not improve from 0.01082
Epoch 5/15
 - 791s - loss: 3.2850e-04 - acc: 0.4308 - val_loss: 0.0110 - val_acc: 0.2767

Epoch 00005: val_loss did not improve from 0.01082

Epoch 00005: ReduceLROnPlateau reducing learning rate to 6.24999984211172e-07.
Epoch 6/15
 - 797s - loss: 3.2761e-04 - acc: 0.4307 - val_loss: 0.0110 - val_acc: 0.2764

Epoch 00006: val_loss did not improve from 0.01082
Epoch 7/15
 - 795s - loss: 3.3001e-04 - acc: 0.4308 - val_loss: 0.0110 - val_acc: 0.2763

Epoch 00007: val_loss did not improve from 0.01082

Epoch 00007: ReduceLROnPlateau reducing learning rate to 1.56249996052793e-07.
Epoch 8/15
 - 794s - loss: 3.2746e-04 - acc: 0.4307 - val_loss: 0.0110 - val_acc: 0.2763

Epoch 00008: val_loss did not improve from 0.01082
Epoch 9/15
 - 791s - loss: 3.2785e-04 - acc: 0.4307 - val_loss: 0.0110 - val_acc: 0.2763

Epoch 00009: val_loss did not improve from 0.01082

Epoch 00009: ReduceLROnPlateau reducing learning rate to 3.906249901319825e-08.
Epoch 10/15
 - 793s - loss: 3.2737e-04 - acc: 0.4307 - val_loss: 0.0110 - val_acc: 0.2762

Epoch 00010: val_loss did not improve from 0.01082
Epoch 11/15
 - 792s - loss: 3.2713e-04 - acc: 0.4307 - val_loss: 0.0110 - val_acc: 0.2766

Epoch 00011: val_loss did not improve from 0.01082

Epoch 00011: ReduceLROnPlateau reducing learning rate to 9.765624753299562e-09.
Epoch 12/15
 - 792s - loss: 3.2788e-04 - acc: 0.4307 - val_loss: 0.0110 - val_acc: 0.2769

Epoch 00012: val_loss did not improve from 0.01082
Epoch 13/15
 - 791s - loss: 3.2818e-04 - acc: 0.4307 - val_loss: 0.0110 - val_acc: 0.2767

Epoch 00013: val_loss did not improve from 0.01082

Epoch 00013: ReduceLROnPlateau reducing learning rate to 2.4414061883248905e-09.
Epoch 14/15
 - 791s - loss: 3.2874e-04 - acc: 0.4307 - val_loss: 0.0110 - val_acc: 0.2768

Epoch 00014: val_loss did not improve from 0.01082
Epoch 15/15
 - 794s - loss: 3.2923e-04 - acc: 0.4307 - val_loss: 0.0110 - val_acc: 0.2767

Epoch 00015: val_loss did not improve from 0.01082

Epoch 00015: ReduceLROnPlateau reducing learning rate to 6.103515470812226e-10.
*********************************************************
Running python analyze_model.py
JOB 5141 is running on node01 
*********************************************************


Running over 5 testing events to generate plots.

Reading info from configuration:
Running over 25 testing events to calculate statistics.

IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TESTING: /scratch/arbint/input_files/testing/feature_w.csv
LABEL_FILE_TESTING: /scratch/arbint/input_files/testing/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]


Number of validation samples IoU evaulated on: 25
IoU for Background is: 0.793
IoU for Cosmic is: 0.129
IoU for Beam is: 0.017
Average IoU is: 0.313

Test accuracy of the model is: 66.03%

Done!

