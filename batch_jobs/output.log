
*********************************************************
This was run on:
Tue Nov 27 15:52:31 EST 2018
*********************************************************

*********************************************************
Running python train_model.py
JOB 5144 is running on node04 
*********************************************************


Reading info from configuration:

Runnning in training setting!

NUM_TRAINING: 3626
NUM_VALIDATION: 514
NUM_EPOCHS: 15
BATCH_SIZE: 2
IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TRAINING: /scratch/arbint/input_files/training/feature_w.csv
LABEL_FILE_TRAINING: /scratch/arbint/input_files/training/label_w.csv
FEATURE_FILE_VALIDATION: /scratch/arbint/input_files/validation/feature_w.csv
LABEL_FILE_VALIDATION: /scratch/arbint/input_files/validation/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]

Epoch 1/15
 - 924s - loss: 0.0386 - acc: 0.2248 - val_loss: 1.2665 - val_acc: 0.4665

Epoch 00001: val_loss improved from inf to 1.26650, saving model to saved_models/model_and_weights.hdf5
Epoch 2/15
 - 873s - loss: 0.0342 - acc: 0.2826 - val_loss: 0.5034 - val_acc: 0.4645

Epoch 00002: val_loss improved from 1.26650 to 0.50339, saving model to saved_models/model_and_weights.hdf5
Epoch 3/15
 - 873s - loss: 0.0340 - acc: 0.2984 - val_loss: 0.0806 - val_acc: 0.4654

Epoch 00003: val_loss improved from 0.50339 to 0.08064, saving model to saved_models/model_and_weights.hdf5
Epoch 4/15
 - 873s - loss: 0.0339 - acc: 0.3124 - val_loss: 0.0423 - val_acc: 0.0697

Epoch 00004: val_loss improved from 0.08064 to 0.04227, saving model to saved_models/model_and_weights.hdf5
Epoch 5/15
 - 874s - loss: 0.0339 - acc: 0.3204 - val_loss: 0.0418 - val_acc: 0.8631

Epoch 00005: val_loss improved from 0.04227 to 0.04179, saving model to saved_models/model_and_weights.hdf5
Epoch 6/15
 - 873s - loss: 0.0338 - acc: 0.3357 - val_loss: 0.0410 - val_acc: 0.8889

Epoch 00006: val_loss improved from 0.04179 to 0.04100, saving model to saved_models/model_and_weights.hdf5
Epoch 7/15
 - 873s - loss: 0.0338 - acc: 0.3501 - val_loss: 0.2169 - val_acc: 0.5605

Epoch 00007: val_loss did not improve from 0.04100
Epoch 8/15
 - 873s - loss: 0.0338 - acc: 0.3643 - val_loss: 0.0419 - val_acc: 0.4050

Epoch 00008: val_loss did not improve from 0.04100

Epoch 00008: ReduceLROnPlateau reducing learning rate to 2.499999936844688e-06.
Epoch 9/15
 - 873s - loss: 0.0338 - acc: 0.4151 - val_loss: 0.0725 - val_acc: 0.4956

Epoch 00009: val_loss did not improve from 0.04100
Epoch 10/15
 - 873s - loss: 0.0338 - acc: 0.4167 - val_loss: 0.1527 - val_acc: 0.4928

Epoch 00010: val_loss did not improve from 0.04100

Epoch 00010: ReduceLROnPlateau reducing learning rate to 6.24999984211172e-07.
Epoch 11/15
 - 874s - loss: 0.0338 - acc: 0.4442 - val_loss: 0.0422 - val_acc: 0.8889

Epoch 00011: val_loss did not improve from 0.04100
Epoch 12/15
 - 878s - loss: 0.0338 - acc: 0.4452 - val_loss: 0.0423 - val_acc: 0.1364

Epoch 00012: val_loss did not improve from 0.04100

Epoch 00012: ReduceLROnPlateau reducing learning rate to 1.56249996052793e-07.
Epoch 13/15
 - 875s - loss: 0.0338 - acc: 0.4197 - val_loss: 0.0433 - val_acc: 0.5354

Epoch 00013: val_loss did not improve from 0.04100
Epoch 14/15
 - 874s - loss: 0.0338 - acc: 0.4411 - val_loss: 0.0423 - val_acc: 0.5079

Epoch 00014: val_loss did not improve from 0.04100

Epoch 00014: ReduceLROnPlateau reducing learning rate to 3.906249901319825e-08.
Epoch 15/15
 - 873s - loss: 0.0338 - acc: 0.4120 - val_loss: 0.0423 - val_acc: 0.5816

Epoch 00015: val_loss did not improve from 0.04100
*********************************************************
Running python analyze_model.py
JOB 5144 is running on node04 
*********************************************************


Running over 5 testing events to generate plots.

Reading info from configuration:
Running over 25 testing events to calculate statistics.

IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TESTING: /scratch/arbint/input_files/testing/feature_w.csv
LABEL_FILE_TESTING: /scratch/arbint/input_files/testing/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]


Number of validation samples IoU evaulated on: 25
IoU for Background is: 0.710
IoU for Cosmic is: 0.060
IoU for Beam is: 0.022
Average IoU is: 0.264

Test accuracy of the model is: 53.80%

Done!

