
*********************************************************
This was run on:
Tue Nov 27 15:52:28 EST 2018
*********************************************************

*********************************************************
Running python train_model.py
JOB 5142 is running on node02 
*********************************************************


Reading info from configuration:

Runnning in training setting!

NUM_TRAINING: 3626
NUM_VALIDATION: 514
NUM_EPOCHS: 15
BATCH_SIZE: 2
IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TRAINING: /scratch/arbint/input_files/training/feature_w.csv
LABEL_FILE_TRAINING: /scratch/arbint/input_files/training/label_w.csv
FEATURE_FILE_VALIDATION: /scratch/arbint/input_files/validation/feature_w.csv
LABEL_FILE_VALIDATION: /scratch/arbint/input_files/validation/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]

Epoch 1/15
 - 841s - loss: 0.0686 - acc: 0.0767 - val_loss: 3.7957 - val_acc: 0.0346

Epoch 00001: val_loss improved from inf to 3.79567, saving model to saved_models/model_and_weights.hdf5
Epoch 2/15
 - 791s - loss: 0.0684 - acc: 0.0774 - val_loss: 3.7884 - val_acc: 0.0352

Epoch 00002: val_loss improved from 3.79567 to 3.78837, saving model to saved_models/model_and_weights.hdf5
Epoch 3/15
 - 792s - loss: 0.0679 - acc: 0.0784 - val_loss: 3.7816 - val_acc: 0.0340

Epoch 00003: val_loss improved from 3.78837 to 3.78163, saving model to saved_models/model_and_weights.hdf5
Epoch 4/15
 - 792s - loss: 0.0676 - acc: 0.0792 - val_loss: 3.7734 - val_acc: 0.0330

Epoch 00004: val_loss improved from 3.78163 to 3.77340, saving model to saved_models/model_and_weights.hdf5
Epoch 5/15
 - 793s - loss: 0.0670 - acc: 0.0801 - val_loss: 3.7627 - val_acc: 0.0325

Epoch 00005: val_loss improved from 3.77340 to 3.76266, saving model to saved_models/model_and_weights.hdf5
Epoch 6/15
 - 798s - loss: 0.0666 - acc: 0.0810 - val_loss: 3.7523 - val_acc: 0.0314

Epoch 00006: val_loss improved from 3.76266 to 3.75231, saving model to saved_models/model_and_weights.hdf5
Epoch 7/15
 - 791s - loss: 0.0662 - acc: 0.0820 - val_loss: 3.7398 - val_acc: 0.0318

Epoch 00007: val_loss improved from 3.75231 to 3.73980, saving model to saved_models/model_and_weights.hdf5
Epoch 8/15
 - 790s - loss: 0.0658 - acc: 0.0828 - val_loss: 3.7266 - val_acc: 0.0319

Epoch 00008: val_loss improved from 3.73980 to 3.72660, saving model to saved_models/model_and_weights.hdf5
Epoch 9/15
 - 792s - loss: 0.0652 - acc: 0.0837 - val_loss: 3.7118 - val_acc: 0.0318

Epoch 00009: val_loss improved from 3.72660 to 3.71178, saving model to saved_models/model_and_weights.hdf5
Epoch 10/15
 - 793s - loss: 0.0650 - acc: 0.0846 - val_loss: 3.7002 - val_acc: 0.0307

Epoch 00010: val_loss improved from 3.71178 to 3.70020, saving model to saved_models/model_and_weights.hdf5
Epoch 11/15
 - 792s - loss: 0.0647 - acc: 0.0855 - val_loss: 3.6857 - val_acc: 0.0306

Epoch 00011: val_loss improved from 3.70020 to 3.68572, saving model to saved_models/model_and_weights.hdf5
Epoch 12/15
 - 791s - loss: 0.0643 - acc: 0.0864 - val_loss: 3.6686 - val_acc: 0.0301

Epoch 00012: val_loss improved from 3.68572 to 3.66860, saving model to saved_models/model_and_weights.hdf5
Epoch 13/15
 - 795s - loss: 0.0638 - acc: 0.0873 - val_loss: 3.6546 - val_acc: 0.0298

Epoch 00013: val_loss improved from 3.66860 to 3.65457, saving model to saved_models/model_and_weights.hdf5
Epoch 14/15
 - 791s - loss: 0.0636 - acc: 0.0883 - val_loss: 3.6384 - val_acc: 0.0299

Epoch 00014: val_loss improved from 3.65457 to 3.63844, saving model to saved_models/model_and_weights.hdf5
Epoch 15/15
 - 796s - loss: 0.0632 - acc: 0.0891 - val_loss: 3.6205 - val_acc: 0.0300

Epoch 00015: val_loss improved from 3.63844 to 3.62055, saving model to saved_models/model_and_weights.hdf5
*********************************************************
Running python analyze_model.py
JOB 5142 is running on node02 
*********************************************************


Running over 5 testing events to generate plots.

Reading info from configuration:
Running over 25 testing events to calculate statistics.

IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TESTING: /scratch/arbint/input_files/testing/feature_w.csv
LABEL_FILE_TESTING: /scratch/arbint/input_files/testing/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]


Number of validation samples IoU evaulated on: 25
IoU for Background is: 0.171
IoU for Cosmic is: 0.158
IoU for Beam is: 0.020
Average IoU is: 0.116

Test accuracy of the model is: 13.95%

Done!

