
*********************************************************
This was run on:
Tue Nov 27 19:54:00 EST 2018
*********************************************************

*********************************************************
Running python train_model.py
JOB 5147 is running on node02 
*********************************************************


Reading info from configuration:

Runnning in training setting!

NUM_TRAINING: 3626
NUM_VALIDATION: 514
NUM_EPOCHS: 30
BATCH_SIZE: 2
IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TRAINING: /scratch/arbint/input_files/training/feature_w.csv
LABEL_FILE_TRAINING: /scratch/arbint/input_files/training/label_w.csv
FEATURE_FILE_VALIDATION: /scratch/arbint/input_files/validation/feature_w.csv
LABEL_FILE_VALIDATION: /scratch/arbint/input_files/validation/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]

Old weights found!
Old weights loaded successfully!
Epoch 1/30
 - 838s - loss: 0.0627 - acc: 0.0901 - val_loss: 3.6041 - val_acc: 0.0302

Epoch 00001: val_loss improved from inf to 3.60408, saving model to saved_models/model_and_weights.hdf5
Epoch 2/30
 - 792s - loss: 0.0622 - acc: 0.0910 - val_loss: 3.5859 - val_acc: 0.0300

Epoch 00002: val_loss improved from 3.60408 to 3.58592, saving model to saved_models/model_and_weights.hdf5
Epoch 3/30
 - 793s - loss: 0.0620 - acc: 0.0920 - val_loss: 3.5674 - val_acc: 0.0300

Epoch 00003: val_loss improved from 3.58592 to 3.56739, saving model to saved_models/model_and_weights.hdf5
Epoch 4/30
 - 790s - loss: 0.0617 - acc: 0.0930 - val_loss: 3.5463 - val_acc: 0.0297

Epoch 00004: val_loss improved from 3.56739 to 3.54631, saving model to saved_models/model_and_weights.hdf5
Epoch 5/30
 - 791s - loss: 0.0611 - acc: 0.0939 - val_loss: 3.5300 - val_acc: 0.0296

Epoch 00005: val_loss improved from 3.54631 to 3.52999, saving model to saved_models/model_and_weights.hdf5
Epoch 6/30
 - 791s - loss: 0.0607 - acc: 0.0949 - val_loss: 3.5080 - val_acc: 0.0296

Epoch 00006: val_loss improved from 3.52999 to 3.50803, saving model to saved_models/model_and_weights.hdf5
Epoch 7/30
 - 790s - loss: 0.0603 - acc: 0.0959 - val_loss: 3.4876 - val_acc: 0.0292

Epoch 00007: val_loss improved from 3.50803 to 3.48760, saving model to saved_models/model_and_weights.hdf5
Epoch 8/30
 - 790s - loss: 0.0602 - acc: 0.0969 - val_loss: 3.4658 - val_acc: 0.0291

Epoch 00008: val_loss improved from 3.48760 to 3.46583, saving model to saved_models/model_and_weights.hdf5
Epoch 9/30
 - 790s - loss: 0.0597 - acc: 0.0979 - val_loss: 3.4419 - val_acc: 0.0283

Epoch 00009: val_loss improved from 3.46583 to 3.44187, saving model to saved_models/model_and_weights.hdf5
Epoch 10/30
 - 791s - loss: 0.0593 - acc: 0.0990 - val_loss: 3.4189 - val_acc: 0.0288

Epoch 00010: val_loss improved from 3.44187 to 3.41889, saving model to saved_models/model_and_weights.hdf5
Epoch 11/30
 - 792s - loss: 0.0589 - acc: 0.1000 - val_loss: 3.3953 - val_acc: 0.0290

Epoch 00011: val_loss improved from 3.41889 to 3.39535, saving model to saved_models/model_and_weights.hdf5
Epoch 12/30
 - 793s - loss: 0.0587 - acc: 0.1010 - val_loss: 3.3742 - val_acc: 0.0295

Epoch 00012: val_loss improved from 3.39535 to 3.37422, saving model to saved_models/model_and_weights.hdf5
Epoch 13/30
 - 791s - loss: 0.0581 - acc: 0.1021 - val_loss: 3.3525 - val_acc: 0.0295

Epoch 00013: val_loss improved from 3.37422 to 3.35251, saving model to saved_models/model_and_weights.hdf5
Epoch 14/30
 - 791s - loss: 0.0578 - acc: 0.1031 - val_loss: 3.3293 - val_acc: 0.0296

Epoch 00014: val_loss improved from 3.35251 to 3.32927, saving model to saved_models/model_and_weights.hdf5
Epoch 15/30
 - 791s - loss: 0.0574 - acc: 0.1042 - val_loss: 3.3049 - val_acc: 0.0294

Epoch 00015: val_loss improved from 3.32927 to 3.30490, saving model to saved_models/model_and_weights.hdf5
Epoch 16/30
 - 791s - loss: 0.0571 - acc: 0.1052 - val_loss: 3.2812 - val_acc: 0.0292

Epoch 00016: val_loss improved from 3.30490 to 3.28123, saving model to saved_models/model_and_weights.hdf5
Epoch 17/30
 - 792s - loss: 0.0570 - acc: 0.1063 - val_loss: 3.2586 - val_acc: 0.0287

Epoch 00017: val_loss improved from 3.28123 to 3.25859, saving model to saved_models/model_and_weights.hdf5
Epoch 18/30
 - 790s - loss: 0.0564 - acc: 0.1073 - val_loss: 3.2342 - val_acc: 0.0284

Epoch 00018: val_loss improved from 3.25859 to 3.23421, saving model to saved_models/model_and_weights.hdf5
Epoch 19/30
 - 790s - loss: 0.0561 - acc: 0.1084 - val_loss: 3.2079 - val_acc: 0.0279

Epoch 00019: val_loss improved from 3.23421 to 3.20787, saving model to saved_models/model_and_weights.hdf5
Epoch 20/30
 - 791s - loss: 0.0559 - acc: 0.1095 - val_loss: 3.1800 - val_acc: 0.0278

Epoch 00020: val_loss improved from 3.20787 to 3.18000, saving model to saved_models/model_and_weights.hdf5
Epoch 21/30
 - 791s - loss: 0.0556 - acc: 0.1106 - val_loss: 3.1579 - val_acc: 0.0277

Epoch 00021: val_loss improved from 3.18000 to 3.15785, saving model to saved_models/model_and_weights.hdf5
Epoch 22/30
 - 792s - loss: 0.0553 - acc: 0.1118 - val_loss: 3.1339 - val_acc: 0.0273

Epoch 00022: val_loss improved from 3.15785 to 3.13387, saving model to saved_models/model_and_weights.hdf5
Epoch 23/30
 - 791s - loss: 0.0550 - acc: 0.1129 - val_loss: 3.1086 - val_acc: 0.0278

Epoch 00023: val_loss improved from 3.13387 to 3.10856, saving model to saved_models/model_and_weights.hdf5
Epoch 24/30
 - 796s - loss: 0.0547 - acc: 0.1141 - val_loss: 3.0814 - val_acc: 0.0277

Epoch 00024: val_loss improved from 3.10856 to 3.08137, saving model to saved_models/model_and_weights.hdf5
Epoch 25/30
 - 795s - loss: 0.0543 - acc: 0.1152 - val_loss: 3.0563 - val_acc: 0.0279

Epoch 00025: val_loss improved from 3.08137 to 3.05629, saving model to saved_models/model_and_weights.hdf5
Epoch 26/30
 - 791s - loss: 0.0540 - acc: 0.1164 - val_loss: 3.0311 - val_acc: 0.0281

Epoch 00026: val_loss improved from 3.05629 to 3.03105, saving model to saved_models/model_and_weights.hdf5
Epoch 27/30
 - 791s - loss: 0.0537 - acc: 0.1176 - val_loss: 3.0051 - val_acc: 0.0277

Epoch 00027: val_loss improved from 3.03105 to 3.00513, saving model to saved_models/model_and_weights.hdf5
Epoch 28/30
 - 791s - loss: 0.0536 - acc: 0.1187 - val_loss: 2.9797 - val_acc: 0.0277

Epoch 00028: val_loss improved from 3.00513 to 2.97973, saving model to saved_models/model_and_weights.hdf5
Epoch 29/30
 - 791s - loss: 0.0532 - acc: 0.1198 - val_loss: 2.9526 - val_acc: 0.0276

Epoch 00029: val_loss improved from 2.97973 to 2.95261, saving model to saved_models/model_and_weights.hdf5
Epoch 30/30
 - 791s - loss: 0.0528 - acc: 0.1209 - val_loss: 2.9320 - val_acc: 0.0278

Epoch 00030: val_loss improved from 2.95261 to 2.93198, saving model to saved_models/model_and_weights.hdf5
*********************************************************
Running python analyze_model.py
JOB 5147 is running on node02 
*********************************************************


Running over 5 testing events to generate plots.

Reading info from configuration:
Running over 25 testing events to calculate statistics.

IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TESTING: /scratch/arbint/input_files/testing/feature_w.csv
LABEL_FILE_TESTING: /scratch/arbint/input_files/testing/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]


Number of validation samples IoU evaulated on: 25
IoU for Background is: 0.409
IoU for Cosmic is: 0.157
IoU for Beam is: 0.019
Average IoU is: 0.195

Test accuracy of the model is: 28.30%

Done!

