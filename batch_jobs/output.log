
*********************************************************
This was run on:
Tue Nov 20 12:03:24 EST 2018
*********************************************************

*********************************************************
Running python train_model.py
JOB 5046 is running on node03 
*********************************************************


Reading info from configuration:

Runnning in training setting!

NUM_TRAINING: 7815
NUM_VALIDATION: 1019
NUM_EPOCHS: 30
BATCH_SIZE: 2
IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TRAINING: /scratch/arbint/input_files/training/feature_w.csv
LABEL_FILE_TRAINING: /scratch/arbint/input_files/training/label_w.csv
FEATURE_FILE_VALIDATION: /scratch/arbint/input_files/validation/feature_w.csv
LABEL_FILE_VALIDATION: /scratch/arbint/input_files/validation/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]

Epoch 1/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1821s - loss: 0.0626 - acc: 0.8088 - val_loss: 0.0477 - val_acc: 0.8547

Epoch 00001: val_loss improved from inf to 0.04769, saving model to saved_models/model_and_weights.hdf5
Epoch 2/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1807s - loss: 0.0514 - acc: 0.7624 - val_loss: 0.0446 - val_acc: 0.8138

Epoch 00002: val_loss improved from 0.04769 to 0.04457, saving model to saved_models/model_and_weights.hdf5
Epoch 3/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1807s - loss: 0.0485 - acc: 0.7197 - val_loss: 0.0430 - val_acc: 0.7729

Epoch 00003: val_loss improved from 0.04457 to 0.04302, saving model to saved_models/model_and_weights.hdf5
Epoch 4/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1809s - loss: 0.0467 - acc: 0.6809 - val_loss: 0.0420 - val_acc: 0.7347

Epoch 00004: val_loss improved from 0.04302 to 0.04202, saving model to saved_models/model_and_weights.hdf5
Epoch 5/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1805s - loss: 0.0455 - acc: 0.6456 - val_loss: 0.0413 - val_acc: 0.6983

Epoch 00005: val_loss improved from 0.04202 to 0.04128, saving model to saved_models/model_and_weights.hdf5
Epoch 6/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1805s - loss: 0.0445 - acc: 0.6136 - val_loss: 0.0408 - val_acc: 0.6674

Epoch 00006: val_loss improved from 0.04128 to 0.04076, saving model to saved_models/model_and_weights.hdf5
Epoch 7/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1804s - loss: 0.0438 - acc: 0.5846 - val_loss: 0.0404 - val_acc: 0.6366

Epoch 00007: val_loss improved from 0.04076 to 0.04037, saving model to saved_models/model_and_weights.hdf5
Epoch 8/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1804s - loss: 0.0433 - acc: 0.5589 - val_loss: 0.0401 - val_acc: 0.6085

Epoch 00008: val_loss improved from 0.04037 to 0.04006, saving model to saved_models/model_and_weights.hdf5
Epoch 9/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1806s - loss: 0.0428 - acc: 0.5363 - val_loss: 0.0398 - val_acc: 0.5849

Epoch 00009: val_loss improved from 0.04006 to 0.03982, saving model to saved_models/model_and_weights.hdf5
Epoch 10/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1807s - loss: 0.0424 - acc: 0.5166 - val_loss: 0.0396 - val_acc: 0.5625

Epoch 00010: val_loss improved from 0.03982 to 0.03961, saving model to saved_models/model_and_weights.hdf5
Epoch 11/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1809s - loss: 0.0421 - acc: 0.4993 - val_loss: 0.0394 - val_acc: 0.5423

Epoch 00011: val_loss improved from 0.03961 to 0.03944, saving model to saved_models/model_and_weights.hdf5
Epoch 12/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1805s - loss: 0.0418 - acc: 0.4844 - val_loss: 0.0393 - val_acc: 0.5243

Epoch 00012: val_loss improved from 0.03944 to 0.03928, saving model to saved_models/model_and_weights.hdf5
Epoch 13/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1807s - loss: 0.0415 - acc: 0.4715 - val_loss: 0.0391 - val_acc: 0.5078

Epoch 00013: val_loss improved from 0.03928 to 0.03915, saving model to saved_models/model_and_weights.hdf5
Epoch 14/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1806s - loss: 0.0413 - acc: 0.4603 - val_loss: 0.0390 - val_acc: 0.4932

Epoch 00014: val_loss improved from 0.03915 to 0.03902, saving model to saved_models/model_and_weights.hdf5
Epoch 15/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1805s - loss: 0.0410 - acc: 0.4506 - val_loss: 0.0389 - val_acc: 0.4807

Epoch 00015: val_loss improved from 0.03902 to 0.03890, saving model to saved_models/model_and_weights.hdf5
Epoch 16/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1804s - loss: 0.0408 - acc: 0.4422 - val_loss: 0.0388 - val_acc: 0.4705

Epoch 00016: val_loss improved from 0.03890 to 0.03878, saving model to saved_models/model_and_weights.hdf5
Epoch 17/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1808s - loss: 0.0406 - acc: 0.4349 - val_loss: 0.0387 - val_acc: 0.4594

Epoch 00017: val_loss improved from 0.03878 to 0.03866, saving model to saved_models/model_and_weights.hdf5
Epoch 18/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1807s - loss: 0.0404 - acc: 0.4283 - val_loss: 0.0386 - val_acc: 0.4507

Epoch 00018: val_loss improved from 0.03866 to 0.03855, saving model to saved_models/model_and_weights.hdf5
Epoch 19/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1804s - loss: 0.0402 - acc: 0.4223 - val_loss: 0.0385 - val_acc: 0.4437

Epoch 00019: val_loss improved from 0.03855 to 0.03845, saving model to saved_models/model_and_weights.hdf5
Epoch 20/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1805s - loss: 0.0401 - acc: 0.4166 - val_loss: 0.0384 - val_acc: 0.4363

Epoch 00020: val_loss improved from 0.03845 to 0.03837, saving model to saved_models/model_and_weights.hdf5
Epoch 21/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1808s - loss: 0.0399 - acc: 0.4111 - val_loss: 0.0383 - val_acc: 0.4291

Epoch 00021: val_loss improved from 0.03837 to 0.03830, saving model to saved_models/model_and_weights.hdf5
Epoch 22/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1803s - loss: 0.0398 - acc: 0.4060 - val_loss: 0.0382 - val_acc: 0.4223

Epoch 00022: val_loss improved from 0.03830 to 0.03824, saving model to saved_models/model_and_weights.hdf5
Epoch 23/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1805s - loss: 0.0397 - acc: 0.4012 - val_loss: 0.0382 - val_acc: 0.4165

Epoch 00023: val_loss improved from 0.03824 to 0.03818, saving model to saved_models/model_and_weights.hdf5
Epoch 24/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1808s - loss: 0.0396 - acc: 0.3968 - val_loss: 0.0381 - val_acc: 0.4120

Epoch 00024: val_loss improved from 0.03818 to 0.03813, saving model to saved_models/model_and_weights.hdf5
Epoch 25/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1806s - loss: 0.0395 - acc: 0.3928 - val_loss: 0.0381 - val_acc: 0.4062

Epoch 00025: val_loss improved from 0.03813 to 0.03809, saving model to saved_models/model_and_weights.hdf5
Epoch 26/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1807s - loss: 0.0394 - acc: 0.3892 - val_loss: 0.0380 - val_acc: 0.4014

Epoch 00026: val_loss improved from 0.03809 to 0.03804, saving model to saved_models/model_and_weights.hdf5

Epoch 00026: ReduceLROnPlateau reducing learning rate to 2.499999936844688e-06.
Epoch 27/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1806s - loss: 0.0394 - acc: 0.3871 - val_loss: 0.0380 - val_acc: 0.3992

Epoch 00027: val_loss improved from 0.03804 to 0.03804, saving model to saved_models/model_and_weights.hdf5
Epoch 28/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1806s - loss: 0.0394 - acc: 0.3865 - val_loss: 0.0380 - val_acc: 0.3979

Epoch 00028: val_loss improved from 0.03804 to 0.03803, saving model to saved_models/model_and_weights.hdf5

Epoch 00028: ReduceLROnPlateau reducing learning rate to 6.24999984211172e-07.
Epoch 29/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1804s - loss: 0.0394 - acc: 0.3861 - val_loss: 0.0380 - val_acc: 0.3982

Epoch 00029: val_loss improved from 0.03803 to 0.03803, saving model to saved_models/model_and_weights.hdf5
Epoch 30/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1805s - loss: 0.0394 - acc: 0.3860 - val_loss: 0.0380 - val_acc: 0.3983

Epoch 00030: val_loss did not improve from 0.03803
*********************************************************
Running python analyze_model.py
JOB 5046 is running on node03 
*********************************************************


Running over 5 testing events to generate plots.

Reading info from configuration:
Running over 25 testing events to calculate statistics.

IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TESTING: /scratch/arbint/input_files/testing/feature_w.csv
LABEL_FILE_TESTING: /scratch/arbint/input_files/testing/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]


Number of validation samples IoU evaulated on: 25
IoU for Background is: 0.456
IoU for Cosmic is: 0.148
IoU for Beam is: 0.016
Average IoU is: 0.206

Test accuracy of the model is: 30.73%

Done!

