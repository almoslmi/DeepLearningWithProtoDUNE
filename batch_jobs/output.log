
*********************************************************
This was run on:
Tue Nov 20 12:03:30 EST 2018
*********************************************************

*********************************************************
Running python train_model.py
JOB 5049 is running on node06 
*********************************************************


Reading info from configuration:

Runnning in training setting!

NUM_TRAINING: 7815
NUM_VALIDATION: 1019
NUM_EPOCHS: 30
BATCH_SIZE: 2
IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TRAINING: /scratch/arbint/input_files/training/feature_w.csv
LABEL_FILE_TRAINING: /scratch/arbint/input_files/training/label_w.csv
FEATURE_FILE_VALIDATION: /scratch/arbint/input_files/validation/feature_w.csv
LABEL_FILE_VALIDATION: /scratch/arbint/input_files/validation/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]

Epoch 1/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1964s - loss: 0.0352 - acc: 0.3532 - val_loss: 0.5326 - val_acc: 0.5113

Epoch 00001: val_loss improved from inf to 0.53261, saving model to saved_models/model_and_weights.hdf5
Epoch 2/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1942s - loss: 0.0340 - acc: 0.3668 - val_loss: 0.4627 - val_acc: 0.4294

Epoch 00002: val_loss improved from 0.53261 to 0.46268, saving model to saved_models/model_and_weights.hdf5
Epoch 3/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1943s - loss: 0.0339 - acc: 0.3662 - val_loss: 0.2826 - val_acc: 0.3880

Epoch 00003: val_loss improved from 0.46268 to 0.28262, saving model to saved_models/model_and_weights.hdf5
Epoch 4/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1943s - loss: 0.0339 - acc: 0.3635 - val_loss: 0.2857 - val_acc: 0.3749

Epoch 00004: val_loss did not improve from 0.28262
Epoch 5/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1942s - loss: 0.0338 - acc: 0.3636 - val_loss: 0.2025 - val_acc: 0.3197

Epoch 00005: val_loss improved from 0.28262 to 0.20246, saving model to saved_models/model_and_weights.hdf5
Epoch 6/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1944s - loss: 0.0338 - acc: 0.3615 - val_loss: 0.0457 - val_acc: 0.3698

Epoch 00006: val_loss improved from 0.20246 to 0.04565, saving model to saved_models/model_and_weights.hdf5
Epoch 7/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1942s - loss: 0.0338 - acc: 0.3615 - val_loss: 0.0755 - val_acc: 0.2767

Epoch 00007: val_loss did not improve from 0.04565
Epoch 8/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1943s - loss: 0.0338 - acc: 0.3633 - val_loss: 0.3608 - val_acc: 0.2461

Epoch 00008: val_loss did not improve from 0.04565

Epoch 00008: ReduceLROnPlateau reducing learning rate to 2.499999936844688e-06.
Epoch 9/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1945s - loss: 0.0338 - acc: 0.3628 - val_loss: 0.0437 - val_acc: 0.3409

Epoch 00009: val_loss improved from 0.04565 to 0.04365, saving model to saved_models/model_and_weights.hdf5
Epoch 10/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1944s - loss: 0.0338 - acc: 0.3636 - val_loss: 0.0394 - val_acc: 0.5216

Epoch 00010: val_loss improved from 0.04365 to 0.03943, saving model to saved_models/model_and_weights.hdf5
Epoch 11/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1945s - loss: 0.0338 - acc: 0.3642 - val_loss: 0.0403 - val_acc: 0.3868

Epoch 00011: val_loss did not improve from 0.03943
Epoch 12/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1945s - loss: 0.0338 - acc: 0.3643 - val_loss: 0.0413 - val_acc: 0.3314

Epoch 00012: val_loss did not improve from 0.03943

Epoch 00012: ReduceLROnPlateau reducing learning rate to 6.24999984211172e-07.
Epoch 13/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1942s - loss: 0.0338 - acc: 0.3618 - val_loss: 0.0393 - val_acc: 0.5514

Epoch 00013: val_loss improved from 0.03943 to 0.03928, saving model to saved_models/model_and_weights.hdf5
Epoch 14/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1944s - loss: 0.0338 - acc: 0.3635 - val_loss: 0.0392 - val_acc: 0.4975

Epoch 00014: val_loss improved from 0.03928 to 0.03923, saving model to saved_models/model_and_weights.hdf5
Epoch 15/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1945s - loss: 0.0338 - acc: 0.3648 - val_loss: 0.0392 - val_acc: 0.5424

Epoch 00015: val_loss did not improve from 0.03923

Epoch 00015: ReduceLROnPlateau reducing learning rate to 1.56249996052793e-07.
Epoch 16/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1944s - loss: 0.0338 - acc: 0.3648 - val_loss: 0.0392 - val_acc: 0.3431

Epoch 00016: val_loss improved from 0.03923 to 0.03921, saving model to saved_models/model_and_weights.hdf5
Epoch 17/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1945s - loss: 0.0338 - acc: 0.3646 - val_loss: 0.0392 - val_acc: 0.4326

Epoch 00017: val_loss did not improve from 0.03921

Epoch 00017: ReduceLROnPlateau reducing learning rate to 3.906249901319825e-08.
Epoch 18/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1943s - loss: 0.0338 - acc: 0.3647 - val_loss: 0.0392 - val_acc: 0.4010

Epoch 00018: val_loss did not improve from 0.03921
Epoch 19/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1944s - loss: 0.0338 - acc: 0.3648 - val_loss: 0.0392 - val_acc: 0.3443

Epoch 00019: val_loss improved from 0.03921 to 0.03921, saving model to saved_models/model_and_weights.hdf5

Epoch 00019: ReduceLROnPlateau reducing learning rate to 9.765624753299562e-09.
Epoch 20/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1945s - loss: 0.0338 - acc: 0.3647 - val_loss: 0.0392 - val_acc: 0.2980

Epoch 00020: val_loss improved from 0.03921 to 0.03921, saving model to saved_models/model_and_weights.hdf5
Epoch 21/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1945s - loss: 0.0338 - acc: 0.3646 - val_loss: 0.0392 - val_acc: 0.2963

Epoch 00021: val_loss did not improve from 0.03921

Epoch 00021: ReduceLROnPlateau reducing learning rate to 2.4414061883248905e-09.
Epoch 22/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1944s - loss: 0.0338 - acc: 0.3647 - val_loss: 0.0392 - val_acc: 0.3443

Epoch 00022: val_loss did not improve from 0.03921
Epoch 23/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1946s - loss: 0.0338 - acc: 0.3649 - val_loss: 0.0392 - val_acc: 0.3485

Epoch 00023: val_loss did not improve from 0.03921

Epoch 00023: ReduceLROnPlateau reducing learning rate to 6.103515470812226e-10.
Epoch 24/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1944s - loss: 0.0338 - acc: 0.3648 - val_loss: 0.0392 - val_acc: 0.3394

Epoch 00024: val_loss did not improve from 0.03921
Epoch 25/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1943s - loss: 0.0338 - acc: 0.3645 - val_loss: 0.0392 - val_acc: 0.3412

Epoch 00025: val_loss did not improve from 0.03921

Epoch 00025: ReduceLROnPlateau reducing learning rate to 1.5258788677030566e-10.
Epoch 26/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1944s - loss: 0.0338 - acc: 0.3646 - val_loss: 0.0392 - val_acc: 0.3410

Epoch 00026: val_loss did not improve from 0.03921
Epoch 27/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1945s - loss: 0.0338 - acc: 0.3647 - val_loss: 0.0392 - val_acc: 0.3406

Epoch 00027: val_loss did not improve from 0.03921

Epoch 00027: ReduceLROnPlateau reducing learning rate to 3.8146971692576415e-11.
Epoch 28/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1944s - loss: 0.0338 - acc: 0.3648 - val_loss: 0.0392 - val_acc: 0.3419

Epoch 00028: val_loss did not improve from 0.03921
Epoch 29/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1946s - loss: 0.0338 - acc: 0.3647 - val_loss: 0.0392 - val_acc: 0.3458

Epoch 00029: val_loss did not improve from 0.03921

Epoch 00029: ReduceLROnPlateau reducing learning rate to 9.536742923144104e-12.
Epoch 30/30
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1946s - loss: 0.0338 - acc: 0.3646 - val_loss: 0.0392 - val_acc: 0.3430

Epoch 00030: val_loss did not improve from 0.03921
*********************************************************
Running python analyze_model.py
JOB 5049 is running on node06 
*********************************************************


Running over 5 testing events to generate plots.

Reading info from configuration:
Running over 25 testing events to calculate statistics.

IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TESTING: /scratch/arbint/input_files/testing/feature_w.csv
LABEL_FILE_TESTING: /scratch/arbint/input_files/testing/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]


Number of validation samples IoU evaulated on: 25
IoU for Background is: 0.423
IoU for Cosmic is: 0.163
IoU for Beam is: 0.010
Average IoU is: 0.199

Test accuracy of the model is: 30.70%

Done!

