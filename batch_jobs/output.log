
*********************************************************
This was run on:
Mon Nov 19 10:26:48 EST 2018
*********************************************************

*********************************************************
Running python train_model.py
JOB 5041 is running on node08 
*********************************************************


Reading info from configuration:

Runnning in training setting!

NUM_TRAINING: 7815
NUM_VALIDATION: 1019
NUM_EPOCHS: 50
BATCH_SIZE: 2
IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TRAINING: /scratch/arbint/input_files/training/feature_w.csv
LABEL_FILE_TRAINING: /scratch/arbint/input_files/training/label_w.csv
FEATURE_FILE_VALIDATION: /scratch/arbint/input_files/validation/feature_w.csv
LABEL_FILE_VALIDATION: /scratch/arbint/input_files/validation/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]

Epoch 1/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1786s - loss: 0.0771 - acc: 0.1541 - val_loss: 0.0694 - val_acc: 0.1194

Epoch 00001: val_loss improved from inf to 0.06945, saving model to saved_models/model_and_weights.hdf5
Epoch 2/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0709 - acc: 0.1620 - val_loss: 0.0633 - val_acc: 0.1264

Epoch 00002: val_loss improved from 0.06945 to 0.06333, saving model to saved_models/model_and_weights.hdf5
Epoch 3/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0663 - acc: 0.1700 - val_loss: 0.0589 - val_acc: 0.1310

Epoch 00003: val_loss improved from 0.06333 to 0.05893, saving model to saved_models/model_and_weights.hdf5
Epoch 4/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0633 - acc: 0.1776 - val_loss: 0.0561 - val_acc: 0.1363

Epoch 00004: val_loss improved from 0.05893 to 0.05609, saving model to saved_models/model_and_weights.hdf5
Epoch 5/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1770s - loss: 0.0612 - acc: 0.1845 - val_loss: 0.0542 - val_acc: 0.1427

Epoch 00005: val_loss improved from 0.05609 to 0.05422, saving model to saved_models/model_and_weights.hdf5
Epoch 6/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0597 - acc: 0.1908 - val_loss: 0.0529 - val_acc: 0.1500

Epoch 00006: val_loss improved from 0.05422 to 0.05288, saving model to saved_models/model_and_weights.hdf5
Epoch 7/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0585 - acc: 0.1967 - val_loss: 0.0518 - val_acc: 0.1572

Epoch 00007: val_loss improved from 0.05288 to 0.05183, saving model to saved_models/model_and_weights.hdf5
Epoch 8/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0576 - acc: 0.2022 - val_loss: 0.0510 - val_acc: 0.1631

Epoch 00008: val_loss improved from 0.05183 to 0.05099, saving model to saved_models/model_and_weights.hdf5
Epoch 9/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1770s - loss: 0.0568 - acc: 0.2075 - val_loss: 0.0503 - val_acc: 0.1692

Epoch 00009: val_loss improved from 0.05099 to 0.05031, saving model to saved_models/model_and_weights.hdf5
Epoch 10/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0561 - acc: 0.2124 - val_loss: 0.0497 - val_acc: 0.1747

Epoch 00010: val_loss improved from 0.05031 to 0.04972, saving model to saved_models/model_and_weights.hdf5
Epoch 11/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0554 - acc: 0.2171 - val_loss: 0.0492 - val_acc: 0.1808

Epoch 00011: val_loss improved from 0.04972 to 0.04923, saving model to saved_models/model_and_weights.hdf5
Epoch 12/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0549 - acc: 0.2216 - val_loss: 0.0488 - val_acc: 0.1855

Epoch 00012: val_loss improved from 0.04923 to 0.04881, saving model to saved_models/model_and_weights.hdf5
Epoch 13/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1773s - loss: 0.0544 - acc: 0.2258 - val_loss: 0.0484 - val_acc: 0.1915

Epoch 00013: val_loss improved from 0.04881 to 0.04845, saving model to saved_models/model_and_weights.hdf5
Epoch 14/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0540 - acc: 0.2298 - val_loss: 0.0481 - val_acc: 0.1971

Epoch 00014: val_loss improved from 0.04845 to 0.04813, saving model to saved_models/model_and_weights.hdf5
Epoch 15/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0535 - acc: 0.2337 - val_loss: 0.0478 - val_acc: 0.2029

Epoch 00015: val_loss improved from 0.04813 to 0.04784, saving model to saved_models/model_and_weights.hdf5
Epoch 16/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0532 - acc: 0.2372 - val_loss: 0.0476 - val_acc: 0.2089

Epoch 00016: val_loss improved from 0.04784 to 0.04758, saving model to saved_models/model_and_weights.hdf5
Epoch 17/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0528 - acc: 0.2407 - val_loss: 0.0474 - val_acc: 0.2154

Epoch 00017: val_loss improved from 0.04758 to 0.04736, saving model to saved_models/model_and_weights.hdf5
Epoch 18/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0525 - acc: 0.2438 - val_loss: 0.0471 - val_acc: 0.2198

Epoch 00018: val_loss improved from 0.04736 to 0.04715, saving model to saved_models/model_and_weights.hdf5
Epoch 19/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1774s - loss: 0.0522 - acc: 0.2468 - val_loss: 0.0470 - val_acc: 0.2245

Epoch 00019: val_loss improved from 0.04715 to 0.04696, saving model to saved_models/model_and_weights.hdf5
Epoch 20/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0520 - acc: 0.2496 - val_loss: 0.0468 - val_acc: 0.2291

Epoch 00020: val_loss improved from 0.04696 to 0.04678, saving model to saved_models/model_and_weights.hdf5
Epoch 21/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0517 - acc: 0.2523 - val_loss: 0.0466 - val_acc: 0.2324

Epoch 00021: val_loss improved from 0.04678 to 0.04661, saving model to saved_models/model_and_weights.hdf5
Epoch 22/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1773s - loss: 0.0514 - acc: 0.2549 - val_loss: 0.0465 - val_acc: 0.2364

Epoch 00022: val_loss improved from 0.04661 to 0.04647, saving model to saved_models/model_and_weights.hdf5
Epoch 23/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0512 - acc: 0.2573 - val_loss: 0.0463 - val_acc: 0.2402

Epoch 00023: val_loss improved from 0.04647 to 0.04631, saving model to saved_models/model_and_weights.hdf5
Epoch 24/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1773s - loss: 0.0510 - acc: 0.2596 - val_loss: 0.0462 - val_acc: 0.2442

Epoch 00024: val_loss improved from 0.04631 to 0.04618, saving model to saved_models/model_and_weights.hdf5
Epoch 25/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1773s - loss: 0.0508 - acc: 0.2618 - val_loss: 0.0460 - val_acc: 0.2491

Epoch 00025: val_loss improved from 0.04618 to 0.04605, saving model to saved_models/model_and_weights.hdf5
Epoch 26/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0506 - acc: 0.2639 - val_loss: 0.0459 - val_acc: 0.2521

Epoch 00026: val_loss improved from 0.04605 to 0.04592, saving model to saved_models/model_and_weights.hdf5
Epoch 27/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0504 - acc: 0.2660 - val_loss: 0.0458 - val_acc: 0.2558

Epoch 00027: val_loss improved from 0.04592 to 0.04579, saving model to saved_models/model_and_weights.hdf5
Epoch 28/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1773s - loss: 0.0502 - acc: 0.2679 - val_loss: 0.0457 - val_acc: 0.2585

Epoch 00028: val_loss improved from 0.04579 to 0.04568, saving model to saved_models/model_and_weights.hdf5
Epoch 29/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0501 - acc: 0.2698 - val_loss: 0.0456 - val_acc: 0.2622

Epoch 00029: val_loss improved from 0.04568 to 0.04556, saving model to saved_models/model_and_weights.hdf5
Epoch 30/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0499 - acc: 0.2716 - val_loss: 0.0455 - val_acc: 0.2648

Epoch 00030: val_loss improved from 0.04556 to 0.04545, saving model to saved_models/model_and_weights.hdf5
Epoch 31/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1773s - loss: 0.0497 - acc: 0.2734 - val_loss: 0.0453 - val_acc: 0.2682

Epoch 00031: val_loss improved from 0.04545 to 0.04534, saving model to saved_models/model_and_weights.hdf5
Epoch 32/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0496 - acc: 0.2751 - val_loss: 0.0452 - val_acc: 0.2712

Epoch 00032: val_loss improved from 0.04534 to 0.04524, saving model to saved_models/model_and_weights.hdf5
Epoch 33/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0494 - acc: 0.2768 - val_loss: 0.0451 - val_acc: 0.2743

Epoch 00033: val_loss improved from 0.04524 to 0.04513, saving model to saved_models/model_and_weights.hdf5
Epoch 34/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1773s - loss: 0.0493 - acc: 0.2783 - val_loss: 0.0450 - val_acc: 0.2771

Epoch 00034: val_loss improved from 0.04513 to 0.04504, saving model to saved_models/model_and_weights.hdf5
Epoch 35/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0491 - acc: 0.2798 - val_loss: 0.0450 - val_acc: 0.2794

Epoch 00035: val_loss improved from 0.04504 to 0.04495, saving model to saved_models/model_and_weights.hdf5
Epoch 36/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0490 - acc: 0.2814 - val_loss: 0.0449 - val_acc: 0.2812

Epoch 00036: val_loss improved from 0.04495 to 0.04486, saving model to saved_models/model_and_weights.hdf5
Epoch 37/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0489 - acc: 0.2828 - val_loss: 0.0448 - val_acc: 0.2842

Epoch 00037: val_loss improved from 0.04486 to 0.04478, saving model to saved_models/model_and_weights.hdf5
Epoch 38/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0487 - acc: 0.2842 - val_loss: 0.0447 - val_acc: 0.2859

Epoch 00038: val_loss improved from 0.04478 to 0.04469, saving model to saved_models/model_and_weights.hdf5
Epoch 39/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1772s - loss: 0.0486 - acc: 0.2857 - val_loss: 0.0446 - val_acc: 0.2881

Epoch 00039: val_loss improved from 0.04469 to 0.04461, saving model to saved_models/model_and_weights.hdf5
Epoch 40/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1773s - loss: 0.0485 - acc: 0.2870 - val_loss: 0.0445 - val_acc: 0.2904

Epoch 00040: val_loss improved from 0.04461 to 0.04453, saving model to saved_models/model_and_weights.hdf5
Epoch 41/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0484 - acc: 0.2883 - val_loss: 0.0445 - val_acc: 0.2921

Epoch 00041: val_loss improved from 0.04453 to 0.04446, saving model to saved_models/model_and_weights.hdf5
Epoch 42/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0482 - acc: 0.2896 - val_loss: 0.0444 - val_acc: 0.2940

Epoch 00042: val_loss improved from 0.04446 to 0.04439, saving model to saved_models/model_and_weights.hdf5
Epoch 43/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1773s - loss: 0.0481 - acc: 0.2909 - val_loss: 0.0443 - val_acc: 0.2959

Epoch 00043: val_loss improved from 0.04439 to 0.04431, saving model to saved_models/model_and_weights.hdf5
Epoch 44/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0480 - acc: 0.2921 - val_loss: 0.0442 - val_acc: 0.2981

Epoch 00044: val_loss improved from 0.04431 to 0.04425, saving model to saved_models/model_and_weights.hdf5
Epoch 45/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0479 - acc: 0.2932 - val_loss: 0.0442 - val_acc: 0.2994

Epoch 00045: val_loss improved from 0.04425 to 0.04418, saving model to saved_models/model_and_weights.hdf5
Epoch 46/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1773s - loss: 0.0478 - acc: 0.2944 - val_loss: 0.0441 - val_acc: 0.3007

Epoch 00046: val_loss improved from 0.04418 to 0.04412, saving model to saved_models/model_and_weights.hdf5
Epoch 47/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0477 - acc: 0.2954 - val_loss: 0.0441 - val_acc: 0.3022

Epoch 00047: val_loss improved from 0.04412 to 0.04405, saving model to saved_models/model_and_weights.hdf5
Epoch 48/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0476 - acc: 0.2965 - val_loss: 0.0440 - val_acc: 0.3039

Epoch 00048: val_loss improved from 0.04405 to 0.04399, saving model to saved_models/model_and_weights.hdf5
Epoch 49/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1773s - loss: 0.0475 - acc: 0.2976 - val_loss: 0.0439 - val_acc: 0.3056

Epoch 00049: val_loss improved from 0.04399 to 0.04394, saving model to saved_models/model_and_weights.hdf5
Epoch 50/50
CSV iteration end for feature. Calling 'break'.
CSV iteration end for feature. Calling 'break'.
 - 1771s - loss: 0.0474 - acc: 0.2986 - val_loss: 0.0439 - val_acc: 0.3064

Epoch 00050: val_loss improved from 0.04394 to 0.04387, saving model to saved_models/model_and_weights.hdf5
*********************************************************
Running python analyze_model.py
JOB 5041 is running on node08 
*********************************************************


Running over 5 testing events to generate plots.

Reading info from configuration:
Running over 25 testing events to calculate statistics.

IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TESTING: /scratch/arbint/input_files/testing/feature_w.csv
LABEL_FILE_TESTING: /scratch/arbint/input_files/testing/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]


Number of validation samples IoU evaulated on: 25
IoU for Background is: 0.489
IoU for Cosmic is: 0.178
IoU for Beam is: 0.013
Average IoU is: 0.227

Test accuracy of the model is: 33.85%

Done!

