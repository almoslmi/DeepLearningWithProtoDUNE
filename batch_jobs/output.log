
*********************************************************
This was run on:
Tue Nov 27 19:53:55 EST 2018
*********************************************************

*********************************************************
Running python train_model.py
JOB 5146 is running on node01 
*********************************************************


Reading info from configuration:

Runnning in training setting!

NUM_TRAINING: 3626
NUM_VALIDATION: 514
NUM_EPOCHS: 30
BATCH_SIZE: 2
IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TRAINING: /scratch/arbint/input_files/training/feature_w.csv
LABEL_FILE_TRAINING: /scratch/arbint/input_files/training/label_w.csv
FEATURE_FILE_VALIDATION: /scratch/arbint/input_files/validation/feature_w.csv
LABEL_FILE_VALIDATION: /scratch/arbint/input_files/validation/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]

Old weights found!
Old weights loaded successfully!
Epoch 1/30
 - 841s - loss: 3.2941e-04 - acc: 0.4313 - val_loss: 0.0109 - val_acc: 0.2796

Epoch 00001: val_loss improved from inf to 0.01090, saving model to saved_models/model_and_weights.hdf5
Epoch 2/30
 - 801s - loss: 3.2789e-04 - acc: 0.4310 - val_loss: 0.0110 - val_acc: 0.2752

Epoch 00002: val_loss did not improve from 0.01090
Epoch 3/30
 - 797s - loss: 3.2762e-04 - acc: 0.4306 - val_loss: 0.0110 - val_acc: 0.2742

Epoch 00003: val_loss did not improve from 0.01090

Epoch 00003: ReduceLROnPlateau reducing learning rate to 2.499999936844688e-06.
Epoch 4/30
 - 797s - loss: 3.2724e-04 - acc: 0.4305 - val_loss: 0.0111 - val_acc: 0.2749

Epoch 00004: val_loss did not improve from 0.01090
Epoch 5/30
 - 799s - loss: 3.2708e-04 - acc: 0.4303 - val_loss: 0.0111 - val_acc: 0.2739

Epoch 00005: val_loss did not improve from 0.01090

Epoch 00005: ReduceLROnPlateau reducing learning rate to 6.24999984211172e-07.
Epoch 6/30
 - 804s - loss: 3.2858e-04 - acc: 0.4303 - val_loss: 0.0111 - val_acc: 0.2738

Epoch 00006: val_loss did not improve from 0.01090
Epoch 7/30
 - 799s - loss: 3.2804e-04 - acc: 0.4303 - val_loss: 0.0111 - val_acc: 0.2736

Epoch 00007: val_loss did not improve from 0.01090

Epoch 00007: ReduceLROnPlateau reducing learning rate to 1.56249996052793e-07.
Epoch 8/30
 - 802s - loss: 3.2692e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2732

Epoch 00008: val_loss did not improve from 0.01090
Epoch 9/30
 - 802s - loss: 3.2830e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2736

Epoch 00009: val_loss did not improve from 0.01090

Epoch 00009: ReduceLROnPlateau reducing learning rate to 3.906249901319825e-08.
Epoch 10/30
 - 802s - loss: 3.2726e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2734

Epoch 00010: val_loss did not improve from 0.01090
Epoch 11/30
 - 804s - loss: 3.2774e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2735

Epoch 00011: val_loss did not improve from 0.01090

Epoch 00011: ReduceLROnPlateau reducing learning rate to 9.765624753299562e-09.
Epoch 12/30
 - 795s - loss: 3.2759e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2733

Epoch 00012: val_loss did not improve from 0.01090
Epoch 13/30
 - 802s - loss: 3.2774e-04 - acc: 0.4303 - val_loss: 0.0111 - val_acc: 0.2736

Epoch 00013: val_loss did not improve from 0.01090

Epoch 00013: ReduceLROnPlateau reducing learning rate to 2.4414061883248905e-09.
Epoch 14/30
 - 801s - loss: 3.2843e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2734

Epoch 00014: val_loss did not improve from 0.01090
Epoch 15/30
 - 802s - loss: 3.2753e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2734

Epoch 00015: val_loss did not improve from 0.01090

Epoch 00015: ReduceLROnPlateau reducing learning rate to 6.103515470812226e-10.
Epoch 16/30
 - 800s - loss: 3.2758e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2735

Epoch 00016: val_loss did not improve from 0.01090
Epoch 17/30
 - 797s - loss: 3.2739e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2735

Epoch 00017: val_loss did not improve from 0.01090

Epoch 00017: ReduceLROnPlateau reducing learning rate to 1.5258788677030566e-10.
Epoch 18/30
 - 804s - loss: 3.2804e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2733

Epoch 00018: val_loss did not improve from 0.01090
Epoch 19/30
 - 798s - loss: 3.2864e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2738

Epoch 00019: val_loss did not improve from 0.01090

Epoch 00019: ReduceLROnPlateau reducing learning rate to 3.8146971692576415e-11.
Epoch 20/30
 - 803s - loss: 3.2926e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2727

Epoch 00020: val_loss did not improve from 0.01090
Epoch 21/30
 - 798s - loss: 3.2713e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2735

Epoch 00021: val_loss did not improve from 0.01090

Epoch 00021: ReduceLROnPlateau reducing learning rate to 9.536742923144104e-12.
Epoch 22/30
 - 804s - loss: 3.2913e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2734

Epoch 00022: val_loss did not improve from 0.01090
Epoch 23/30
 - 799s - loss: 3.2756e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2736

Epoch 00023: val_loss did not improve from 0.01090

Epoch 00023: ReduceLROnPlateau reducing learning rate to 2.384185730786026e-12.
Epoch 24/30
 - 799s - loss: 3.2844e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2731

Epoch 00024: val_loss did not improve from 0.01090
Epoch 25/30
 - 804s - loss: 3.2839e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2726

Epoch 00025: val_loss did not improve from 0.01090

Epoch 00025: ReduceLROnPlateau reducing learning rate to 5.960464326965065e-13.
Epoch 26/30
 - 799s - loss: 3.2721e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2733

Epoch 00026: val_loss did not improve from 0.01090
Epoch 27/30
 - 803s - loss: 3.2790e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2733

Epoch 00027: val_loss did not improve from 0.01090

Epoch 00027: ReduceLROnPlateau reducing learning rate to 1.4901160817412662e-13.
Epoch 28/30
 - 802s - loss: 3.2749e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2736

Epoch 00028: val_loss did not improve from 0.01090
Epoch 29/30
 - 804s - loss: 3.2763e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2733

Epoch 00029: val_loss did not improve from 0.01090

Epoch 00029: ReduceLROnPlateau reducing learning rate to 3.7252902043531655e-14.
Epoch 30/30
 - 795s - loss: 3.2801e-04 - acc: 0.4302 - val_loss: 0.0111 - val_acc: 0.2732

Epoch 00030: val_loss did not improve from 0.01090
*********************************************************
Running python analyze_model.py
JOB 5146 is running on node01 
*********************************************************


Running over 5 testing events to generate plots.

Reading info from configuration:
Running over 25 testing events to calculate statistics.

IMAGE_WIDTH: 224
IMAGE_HEIGHT: 224
IMAGE_DEPTH: 1
CLASS_NAMES: ['Background', 'Cosmic', 'Beam']
FEATURE_FILE_TESTING: /scratch/arbint/input_files/testing/feature_w.csv
LABEL_FILE_TESTING: /scratch/arbint/input_files/testing/label_w.csv
WEIGHTS: [0.007 0.07  1.   ]


Number of validation samples IoU evaulated on: 25
IoU for Background is: 0.792
IoU for Cosmic is: 0.129
IoU for Beam is: 0.017
Average IoU is: 0.313

Test accuracy of the model is: 65.89%

Done!

